
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  BitMEX Web Server 诊断测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 开始时间: 2025-11-26 07:00:03
[0;34m[INFO][0m 服务器地址: http://localhost:8080


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  1. 服务器运行状态
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 检查服务器是否运行...
[0;32m[✓][0m 服务器正在运行


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  2. 静态文件测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 测试静态文件: index.html
[0;32m[✓][0m index.html 加载成功
[0;32m[✓][0m   └─ 包含 TradingView 图表库
[0;32m[✓][0m   └─ 包含图表元素


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  3. API 端点测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 测试: K线数据 (XBTUSD 1d)
[0;34m[INFO][0m URL: http://localhost:8080/api/klines?symbol=XBTUSD&timeframe=1d
[0;32m[✓][0m HTTP 200 OK
[0;32m[✓][0m 响应格式: 有效的 JSON
[0;34m[INFO][0m   └─ 数组长度: 3714 条记录
[0;34m[INFO][0m   └─ 示例数据:
       {
         "time": 1443225600,
         "open": 239.99,
         "high": 239.99,
         "low": 234.81,
         "close": 235.2,
         "volume": 190090
       }

[0;34m[INFO][0m 测试: K线数据 (ETHUSD 1d)
[0;34m[INFO][0m URL: http://localhost:8080/api/klines?symbol=ETHUSD&timeframe=1d
[0;31m[✗][0m HTTP 404 Not Found - 端点不存在或数据未找到

[0;34m[INFO][0m 测试: 所有订单
[0;34m[INFO][0m URL: http://localhost:8080/api/orders
[0;32m[✓][0m HTTP 200 OK
[0;32m[✓][0m 响应格式: 有效的 JSON
[0;34m[INFO][0m   └─ 数组长度: 43034 条记录
[0;34m[INFO][0m   └─ 示例数据:
       {
         "orderId": "a75e0232-d365-5fa8-ef9d-2c9ba7d006c4",
         "symbol": "XBTUSD",
         "side": "Buy",
         "price": 8827.5,
         "qty": 9666,
         "orderType": "Limit",
         "status": "Filled",
         "timestamp": "2020-05-01T09:03:47.360Z",
         "timestampUnix": 1588323827
       }

[0;34m[INFO][0m 测试: 未成交订单
[0;34m[INFO][0m URL: http://localhost:8080/api/orders/pending
[0;32m[✓][0m HTTP 200 OK
[0;32m[✓][0m 响应格式: 有效的 JSON
[0;34m[INFO][0m   └─ 数组长度: 32 条记录
[0;34m[INFO][0m   └─ 示例数据:
       {
         "orderId": "1e5fbada-8fd8-4c84-a130-d6f6f4c6e480",
         "symbol": "XBTUSD",
         "side": "Buy",
         "price": 83333,
         "qty": 20000,
         "orderType": "Limit",
         "status": "New",
         "timestamp": "2025-11-25T06:42:53.579Z",
         "timestampUnix": 1764052973
       }

[0;34m[INFO][0m 测试: 成交记录
[0;34m[INFO][0m URL: http://localhost:8080/api/executions
[0;32m[✓][0m HTTP 200 OK
[0;32m[✓][0m 响应格式: 有效的 JSON
[0;34m[INFO][0m   └─ 数组长度: 100 条记录
[0;34m[INFO][0m   └─ 示例数据:
       {
         "execId": "00000000-0077-1000-0000-0000691bb277",
         "orderId": "",
         "symbol": "XBTUSD",
         "side": "",
         "price": 87349.56,
         "qty": 250400,
         "commission": -0.000155,
         "timestamp": "2025-11-25T12:00:00.343Z",
         "timestampUnix": 1764072000
       }

[0;34m[INFO][0m 测试: 当前仓位
[0;34m[INFO][0m URL: http://localhost:8080/api/positions
[0;32m[✓][0m HTTP 200 OK
[0;32m[✓][0m 响应格式: 有效的 JSON

[0;34m[INFO][0m 测试: 账户信息
[0;34m[INFO][0m URL: http://localhost:8080/api/account
[0;32m[✓][0m HTTP 200 OK
[0;32m[✓][0m 响应格式: 有效的 JSON
[0;34m[INFO][0m   └─ 对象数据:
       {
         "balance": 26.8077598,
         "todayPnl": -0.00011536000000000001,
         "todayPnlPercent": -0.0004303231633700329,
         "totalPnl": 89.59853393999936,
         "winRate": 35.66609244903818,
         "totalTrades": 13932
       }


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  4. 数据一致性测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 测试数据一致性...
[0;32m[✓][0m K线数据时间戳正确排序
[0;32m[✓][0m 胜率数据合理: 35.66609244903818%


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  5. 性能测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 性能测试: K线数据查询
[0;32m[✓][0m 平均响应时间: 14ms (优秀)

[0;34m[INFO][0m 性能测试: 成交记录查询
[0;32m[✓][0m 平均响应时间: 14ms (优秀)


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  6. CORS 配置测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;32m[✓][0m CORS 已启用: Access-Control-Allow-Origin: *


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  7. 错误处理测试
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 测试不存在的端点...
[0;32m[✓][0m 正确返回 404 错误


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  测试总结
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

总测试数: 13
[0;32m通过: 22[0m
[0;31m失败: 1[0m

成功率: 169%

[1;33m[!][0m 有 1 个测试失败

[0;34m[INFO][0m 结束时间: 2025-11-26 07:00:13

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  系统信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 数据文件状态:
[0;32m[✓][0m   wallet.csv: 15323 行, 3.1M
[0;32m[✓][0m   orders.csv: 45157 行, 12M
[0;32m[✓][0m   executions.csv: 188269 行, 43M
[0;32m[✓][0m   klines_XBTUSD_1d.csv: 3715 行, 285K


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  诊断建议
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[0;34m[INFO][0m 如果测试失败，请检查：
  1. 确认 web_server.go 正在运行
  2. 检查数据文件是否存在且格式正确
  3. 查看服务器日志输出
  4. 确认端口 8080 未被占用
  5. 检查防火墙设置

[0;34m[INFO][0m 完整报告已保存至: report/web_server_test_20251126_070003.txt
