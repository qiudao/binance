.PHONY: help download-trades sync-trades ls-trades clean-trades download-wallet sync-wallet ls-wallet clean-wallet

# é»˜è®¤æ˜¾ç¤ºå¸®åŠ©
.DEFAULT_GOAL := help

help:
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
	@echo "  BitMEX æ•°æ®ä¸‹è½½å·¥å…·"
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
	@echo ""
	@echo "ğŸ“Š äº¤æ˜“è®°å½• (Trades)"
	@echo "  download-trades    å…¨é‡ä¸‹è½½äº¤æ˜“è®°å½•"
	@echo "  sync-trades        å¢é‡åŒæ­¥äº¤æ˜“è®°å½•"
	@echo "  ls-trades          åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶"
	@echo "  clean-trades       æ¸…ç†æ‰€æœ‰æ–‡ä»¶ï¼ˆéœ€ç¡®è®¤ï¼‰"
	@echo ""
	@echo "ğŸ’° é’±åŒ…å†å² (Wallet)"
	@echo "  download-wallet    å…¨é‡ä¸‹è½½é’±åŒ…å†å²"
	@echo "  sync-wallet        å¢é‡åŒæ­¥é’±åŒ…å†å²"
	@echo "  ls-wallet          åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶"
	@echo "  clean-wallet       æ¸…ç†æ‰€æœ‰æ–‡ä»¶ï¼ˆéœ€ç¡®è®¤ï¼‰"
	@echo ""
	@echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

# ============================================================
# äº¤æ˜“è®°å½• (Trades)
# ============================================================

download-trades:
	@echo "ğŸ“¥ å…¨é‡ä¸‹è½½äº¤æ˜“è®°å½•..."
	@go run bitmex_data.go

sync-trades:
	@echo "ğŸ”„ å¢é‡åŒæ­¥äº¤æ˜“è®°å½•..."
	@go run bitmex_data.go --update

ls-trades:
	@echo "ğŸ“„ äº¤æ˜“è®°å½•æ–‡ä»¶:"
	@ls -lh bitmex_executions_*.csv 2>/dev/null || echo "  (æ— æ–‡ä»¶)"

clean-trades:
	@echo "âš ï¸  è­¦å‘Š: å°†åˆ é™¤æ‰€æœ‰ bitmex_executions_*.csv"
	@read -p "ç¡®è®¤åˆ é™¤? [y/N] " ans; \
	if [ "$$ans" = "y" ] || [ "$$ans" = "Y" ]; then \
		rm -f bitmex_executions_*.csv; \
		echo "âœ“ å·²æ¸…ç†"; \
	else \
		echo "âœ— å·²å–æ¶ˆ"; \
	fi

# ============================================================
# é’±åŒ…å†å² (Wallet)
# ============================================================

download-wallet:
	@echo "ğŸ“¥ å…¨é‡ä¸‹è½½é’±åŒ…å†å²..."
	@go run bitmex_wallet.go

sync-wallet:
	@echo "ğŸ”„ å¢é‡åŒæ­¥é’±åŒ…å†å²..."
	@go run bitmex_wallet.go --update

ls-wallet:
	@echo "ğŸ“„ é’±åŒ…å†å²æ–‡ä»¶:"
	@ls -lh bitmex_wallet_*.csv 2>/dev/null || echo "  (æ— æ–‡ä»¶)"

clean-wallet:
	@echo "âš ï¸  è­¦å‘Š: å°†åˆ é™¤æ‰€æœ‰ bitmex_wallet_*.csv"
	@read -p "ç¡®è®¤åˆ é™¤? [y/N] " ans; \
	if [ "$$ans" = "y" ] || [ "$$ans" = "Y" ]; then \
		rm -f bitmex_wallet_*.csv; \
		echo "âœ“ å·²æ¸…ç†"; \
	else \
		echo "âœ— å·²å–æ¶ˆ"; \
	fi
